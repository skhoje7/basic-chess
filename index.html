<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Basic Chess</title>
  <!-- Chessboard.js styles -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/chessboard.js/1.0.0/css/chessboard.min.css">
  <style>
    :root{
      --bg:#0f172a; /* slate-900 */
      --card:#111827; /* gray-900 */
      --text:#e5e7eb; /* gray-200 */
      --muted:#9ca3af; /* gray-400 */
      --accent:#4f46e5; /* indigo-600 */
    }
    *{box-sizing:border-box}
    body{margin:0;background:linear-gradient(180deg,var(--bg),#111827);color:var(--text);font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,"Apple Color Emoji","Segoe UI Emoji"}
    .wrap{max-width:1100px;margin:32px auto;padding:0 16px}
    .title{display:flex;align-items:center;gap:.5rem}
    .title h1{font-size:1.5rem;margin:0}

    .grid{display:grid;grid-template-columns:1fr 360px;gap:24px}
    @media (max-width: 980px){.grid{grid-template-columns:1fr}}

    .card{background:var(--card);border:1px solid rgba(255,255,255,.05);border-radius:16px;box-shadow:0 10px 30px rgba(0,0,0,.35)}
    .card .head{padding:14px 16px;border-bottom:1px solid rgba(255,255,255,.06);display:flex;align-items:center;justify-content:space-between}
    .card .head h2{font-size:1rem;margin:0;color:var(--text)}
    .card .body{padding:16px}

    #board{max-width:640px;margin:auto}

    .controls{display:flex;flex-wrap:wrap;gap:10px}
    button{appearance:none;border:1px solid rgba(255,255,255,.12);background:#1f2937;color:var(--text);padding:10px 14px;border-radius:12px;font-weight:600;cursor:pointer}
    button:hover{border-color:var(--accent)}

    .status{font-size:.95rem;line-height:1.4;color:var(--muted)}
    .moves{height:300px;overflow:auto;border:1px dashed rgba(255,255,255,.1);border-radius:12px;padding:10px;background:#0b1220}
    .moves ol{margin:0 0 0 20px;padding:0}
    .muted{color:var(--muted)}
    .footer{margin-top:12px;font-size:.85rem;color:var(--muted)}
    a{color:var(--text)}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="title">
      <svg width="28" height="28" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M8 21h8M9 17h6M7 13h10M12 3l4 6H8l4-6Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>
      <h1>Basic Chess</h1>
      <span class="muted">— legal moves, drag & drop, no frills</span>
    </div>

    <div class="grid">
      <div class="card">
        <div class="head">
          <h2>Board</h2>
          <div class="controls">
            <button id="newGameBtn" title="Start a new game">New Game</button>
            <button id="undoBtn" title="Undo last move">Undo</button>
            <button id="flipBtn" title="Flip board">Flip Board</button>
          </div>
        </div>
        <div class="body">
          <div id="board"></div>
          <div class="footer">Pieces & moves powered by <a href="https://github.com/jhlywa/chess.js" target="_blank" rel="noreferrer">chess.js</a> & <a href="https://github.com/oakmac/chessboardjs" target="_blank" rel="noreferrer">chessboard.js</a>.</div>
        </div>
      </div>

      <div class="card">
        <div class="head"><h2>Game Info</h2></div>
        <div class="body">
          <div class="status" id="status">Status…</div>
          <h3 class="muted">Move List</h3>
          <div class="moves" id="moves"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- Dependencies: chess.js for rules, chessboard.js for UI -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/chess.js/0.13.4/chess.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/chessboard.js/1.0.0/js/chessboard.min.js"></script>

  <script>
    // Chess game logic
    const game = new Chess();

    // DOM helpers
    const $status = document.getElementById('status');
    const $movesBox = document.getElementById('moves');

    function renderMoves() {
      const history = game.history({ verbose: true });
      // Build a simple ordered list with move numbers
      let listHtml = '<ol>'; // SAN pairs per move number
      for (let i = 0; i < history.length; i += 2) {
        const white = history[i] ? history[i].san : '';
        const black = history[i + 1] ? history[i + 1].san : '';
        listHtml += `<li>${white}${black ? ' ' + black : ''}</li>`;
      }
      listHtml += '</ol>';
      $movesBox.innerHTML = listHtml;
      $movesBox.scrollTop = $movesBox.scrollHeight;
    }

    function updateStatus() {
      let status = '';
      let moveColor = game.turn() === 'w' ? 'White' : 'Black';

      // Checkmate?
      if (game.isCheckmate()) {
        status = `Game over — ${moveColor} is checkmated.`;
      } else if (game.isDraw()) {
        status = 'Game over — drawn position.';
      } else {
        status = `${moveColor} to move`;
        if (game.inCheck()) status += ' — check!';
      }
      $status.textContent = status;
      renderMoves();
    }

    function onDragStart(source, piece) {
      // block picking up pieces if game over
      if (game.game_over()) return false;
      // only pick up pieces of the current side to move
      if ((game.turn() === 'w' && piece.search(/^b/) !== -1) ||
          (game.turn() === 'b' && piece.search(/^w/) !== -1)) {
        return false;
      }
    }

    function onDrop(source, target) {
      // see if the move is legal
      const move = game.move({ from: source, to: target, promotion: 'q' });
      if (move === null) return 'snapback';
      updateStatus();
    }

    function onSnapEnd() {
      board.position(game.fen());
    }

    // Create the board UI
    const board = Chessboard('board', {
      draggable: true,
      position: 'start',
      onDragStart,
      onDrop,
      onSnapEnd,
    });

    // Controls
    document.getElementById('newGameBtn').addEventListener('click', () => {
      game.reset();
      board.position('start');
      updateStatus();
    });

    document.getElementById('flipBtn').addEventListener('click', () => board.flip());

    document.getElementById('undoBtn').addEventListener('click', () => {
      game.undo();
      board.position(game.fen());
      updateStatus();
    });

    // Initial render
    updateStatus();

    // Make the board responsive
    window.addEventListener('resize', () => board.resize());
  </script>
</body>
</html>
